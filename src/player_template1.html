<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Navidile Player</title>
  <script src="shortcut.js" type="text/javascript"></script>
  <script type="text/javascript">
  var vidid="VIDID"
var mp3src="MP3URL"
var refs =REFS

var imgurl = 'http://mediasite.medschool.pitt.edu/som_mediasite/FileServer/Presentation/'+vidid+ '/slide_%NUMBER%_640_480.jpg';

var media_events = new Array();

var imgnum=0;
var coffset=0;

var media_properties = [ "currentTime",  "playbackRate" ];

var media_properties_elts = null;

var webm = null;



function  image_num(offset, refs1){
	//#document.write('hi')
	num=0
	for (i=0;i<=refs1.length;i++)
	{
		if (refs1[i]>=offset*1000)
		{

			return i
		}
	}
	return i;
}


function init() {
    document._video = document.getElementById("video");
	document.getElementById("mp3").src=mp3src
    webm = document.getElementById("webm");

    init_events();
    init_properties();

    // properties are updated even if no event was triggered
    setInterval(update_properties, 1000);
	

	shortcut.add("Space", function() {
		playpause();
	});
	shortcut.add("Right", function() {
		document._video.currentTime+=15;
	});
	shortcut.add("Left", function() {
		document._video.currentTime-=15;
	});
	shortcut.add("Up", function() {
		document.getElementById("slider").value=document._video.playbackRate+0.1;
	});
	shortcut.add("Down", function() {
		document.getElementById("slider").value=document._video.playbackRate-0.1;
	});
}
document.addEventListener("DOMContentLoaded", init, false);

function init_events() {

    for (key in media_events) {	
	document._video.addEventListener(key, capture, false);
    }

  


 
}


function playpause() {
	if (document._video.paused) {document._video.play();}
	else {document._video.pause();}

 
}
function init_properties() {
    var tbody = document.getElementById("properties");
    var i = 0;
    var tr = null;
    media_properties_elts = new Array(media_properties.length);
    do {
	if (tr == null) tr    = document.createElement("tr");
	var th = document.createElement("th");
	th.textContent = media_properties[i];
	var td = document.createElement("td");
	td.setAttribute("id", "p_" + media_properties[i]);
	var r = eval("document._video." + media_properties[i]);
	td.innerHTML = r;
	if (typeof(r) != "undefined") {
	    td.className = "true";
	} else {
	    td.className = "false";
	}
	tr.appendChild(th);
	tr.appendChild(td);
	media_properties_elts[i] = td;
	if ((++i % 3) == 0) {
	    tbody.appendChild(tr);
	    tr = null;
	}
    } while (i < media_properties.length);
    if (tr != null) tbody.appendChild(tr);
}

function capture(event) {
    media_events[event.type] = media_events[event.type] + 1;

    update_properties();
}


function update_properties() {
    var i = 0;
    for (key in media_properties) {
	media_properties_elts[i++].innerHTML = eval("document._video." + media_properties[key]).toFixed(2);

    }
	coffset=eval("document._video.currentTime")
	var new_img_num =image_num(coffset, refs);
	
	document._video.playbackRate = document.getElementById('slider').value
	
	if (new_img_num != imgnum)
	{
		imgnum=new_img_num;
		document.getElementById("slide").src = imgurl.replace("%NUMBER%", imgnum);
		
	}
}
  </script>
  <link href="http://www.pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/style.css" rel="stylesheet" type="text/css">
</head>
<body>
  <center>
  <h1>Navidile Player Beta Version 0.3</h1>
  <img src="http://www.pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/1.jpg" border="0" height = "480" width="640" id="slide" align="center">


  <div>
    <audio id="video" controls="" preload="none" width="640">
      <source id="mp3"  type="audio/mp3">

      <p>Your user agent does not support the HTML5 Video element.</p>
    </audio>
    <div id="buttons">

	  <input type="image" src="http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/back15.jpg" onmouseover="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/back15-light.jpg';"   onmouseout="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/back15.jpg';"   onclick="document._video.currentTime-=15" />
	  <input type="image" src="http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/play.jpg" onmouseover="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/play-light.jpg';"   onmouseout="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/play.jpg';"   onclick="document._video.play()" />
	  <input type="image" src="http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/pause.jpg" onmouseover="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/pause-light.jpg';"   onmouseout="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/pause.jpg';"   onclick="document._video.pause()" />
	  <input type="image" src="http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/forward15.jpg" onmouseover="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/forward15-light.jpg';"   onmouseout="this.src='http://pittmedicalstudents.com/nikhil/1231656849636548955/navidile_player/forward15.jpg';"   onclick="document._video.currentTime+=15" />
	  <br>
	  rate control:
	  <input type="range" id="slider"  min="0.5" max="2.5" value="1" step="0.1" onchange="document._video.playbackRate=this.value"/>


	  <br>
	  <!--
      <button onclick="document._video.volume+=0.1">volume+=0.1</button>
      <button onclick="document._video.volume-=0.1">volume-=0.1</button>
      <button onclick="document._video.muted=true">mute</button>
      <button onclick="document._video.muted=false">unmute</button><br> -->
    </div>
	
    
    <table summary="The Media Properties table contains the value of the media properties">
      <caption>Media Properties</caption>
      <tbody id="properties">
      </tbody>
    </table>
    <p> This player currently only works with Google Chrome </p>
<!--
  <div id='canPlayType'>
      // @@TODO canPlayType
    </div>
    -->
  </div>
  </center>

<hr>



</body></html>